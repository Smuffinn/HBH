{% extends 'HarborHop/booking_template.html' %}

{% block booking_title %}Cebu Island Hopper Booking{% endblock %}
{% block package_image %}https://gttp.imgix.net/198182/x/0/top-10-tourist-spots-in-cebu-10.jpg{% endblock %}
{% block package_name %}Cebu{% endblock %}
{% block badge_text %}Family Package{% endblock %}
{% block package_title %}4 Islands in 1 Day Tour{% endblock %}
{% block price %}â‚±2,499 per adult (Kids Free){% endblock %}

{% block package_features %}
    <li>4 Islands Tour Package</li>
    <li>Includes Lunch and Snacks</li>
    <li>Free for children under 12</li>
{% endblock %}

{% block booking_form %}
<form method="POST" action="{% url 'payment' %}" class="booking-form">
    {% csrf_token %}
    
    <input type="hidden" name="package_type" value="cebu_hopper">
    <input type="hidden" name="base_price" value="2499">
    
    <!-- Required fields for payment processing -->
    <div class="form-group">
        <label>Name</label>
        <input type="text" name="name" required value="{{ request.user.get_full_name }}">
    </div>

    <div class="form-group">
        <label>Email</label>
        <input type="email" name="email" required value="{{ request.user.email }}">
    </div>

    <div class="form-group">
        <label>Phone Number</label>
        <input type="tel" name="phone_number" required>
    </div>

    <div class="form-group">
        <label>Gender</label>
        <select name="gender" required>
            <option value="M">Male</option>
            <option value="F">Female</option>
            <option value="O">Other</option>
        </select>
    </div>

    <div class="form-group">
        <label>Age</label>
        <input type="number" name="age" required min="0">
    </div>

    <!-- Schedule selection -->
    <div class="form-group">
        <label>Tour Date</label>
        <input type="date" name="travel_date" required 
               min="{{ min_date|default:'' }}" max="{{ max_date|default:'' }}">
    </div>
    
    <div class="form-group">
        <label>Select Time</label>
        <select name="departure_time" required>
            <option value="morning">Morning (8:00 AM)</option>
            <option value="afternoon">Afternoon (1:00 PM)</option>
        </select>
    </div>

    <div class="form-group">
        <label>Number of Adults</label>
        <input type="number" name="passengers" min="1" value="1" required>
    </div>

    <div class="form-group">
        <label>Number of Children (Under 12)</label>
        <input type="number" name="child_passengers" min="0" value="0">
    </div>

    <!-- Hidden schedule_id field that will be set via JavaScript -->
    <input type="hidden" name="schedule_id" id="schedule_id" value="">

    <button type="submit" class="checkout-btn">Proceed to Checkout</button>
</form>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('.booking-form');
    form.addEventListener('submit', function(e) {
        // For demo purposes, set a dummy schedule_id
        // In production, this should be set based on actual available schedules
        document.getElementById('schedule_id').value = '1';
    });
});
</script>
{% endblock %}